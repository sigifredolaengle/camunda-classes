# WeatherOk API Example

![BPMN Diagram](process.png)

|   Nr. | Topic              | Activity                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| :---: | :---               | :---                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|     1 | Create the project | 1. In Eclipse go to 'New --> Project --> Maven Project' and select 'Maven --> camunda-archetype-servlet-war'.  <br> 2. In Group Id: 'com.camunda.demo' in ArtifactId: 'WeatherOkAPI'                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|     2 | Model              | 1. Open 'src/main/resources/process.bpmn' in camunda-modeler. <br> 2. Draw the BPMN diagram. <br> 3. **'Celebrar' User Task**: Add a form with a 'weatherOK' field of type 'boolean'. <br> 4. **'Abrigarse' User Task**: Add a form with a 'weatherOk' field of type 'boolean'. <br> 5. **'Consultar clima' Service Task**: Set the field 'Implementation' = 'Connector'. <br> 6. **'Consultar clima' Service Task**: Switch to the **Connector** tab. Set the **Connector Id** = 'http-connector'.<br> 7. **'Consultar clima' Service Task**: Add the following **Input Parameters**:<br> 7a. **Name** = 'method'. **Type** = 'Text'. **Value** = 'GET'. <br> 7b. **Name** = 'url'. **Type** = 'Script'. **Script Format** = 'freemarker'. **Script Type** = 'Inline Script'. **Script** = 'http://178.62.33.94:8000/weatherOk/${cityName}'.<br> 8. **'Consultar clima' Service Task**: Add the following **Output Parameters**: <br> 8a. **Name** = 'weatherOk'. **Type** = 'Script'. **Script Format** = 'javaScript'. **Script Type** = 'Inline Script'. **Script** = 'S(response).prop("weatherOk").value()' <br> 9. **'Weather ok? Yes' Sequence Flow**: Set the field 'Condition Type' = 'Expression' and 'Expression' = '#{weatherOk}'. <br> 10. **'Weather ok? No' Sequence Flow**: Using the tool icon change its type to a 'Default Flow'. <br>  11. **'Ingresar ciudad' Start Event**: Add a form with a 'cityName' field of type 'string' and a validation of name 'required'. |
|     3 | Configure Eclipse  | 1. Add the following code in the line 142 of the 'pom.xml' file: <br> ``` <dependency> <groupId>org.camunda.connect</groupId> <artifactId>camunda-connect-http-client</artifactId> </dependency> <dependency> <groupId>org.camunda.bpm</groupId> <artifactId>camunda-engine-plugin-connect</artifactId> </dependency> ``` <br> 2. Add the following code in the line 15 of the 'src/test/resources' file: <br> ``` <bean class="org.camunda.connect.plugin.impl.ConnectProcessEnginePlugin" /> ``` |
