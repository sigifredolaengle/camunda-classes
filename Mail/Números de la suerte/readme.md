# Números de la suerte

![BPMN Diagram](process.png)

|   Nr. | Tópico                                   | Actividad                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| :---: | :---                                     | :---                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|     1 | **'Revisar inbox' Service Task**         | 1. En la pestaña 'general' marca las opciones 'Asynchronous Before' y 'Exclusive'. <br> 2. Configura el parámetro 'Implementation' = 'Connector'. <br> 3. Muévete a la pestaña **Connector**. Haz el atributo **Connector Id** = 'mail-poll'.<br> 3. Agrega el siguiente **Ouput Parameter**:<br> 3a. **Name** = 'mails'. **Type** = 'Text'. **Value** = '${mails}'.                                                                                                                                                                                                                                                                  |
|     2 | **Subprocess Task**                      | 1. Usando el ícono de herramienta, agrega el parámetro 'Parallel Multi Instance'. <br> 2. En la pestaña 'General', agrega **Collection**='${mails}' y **Element Variable**='mail'.                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|     3 | **'Revisar correo' User Task**           | 1. En la pestaña 'Forms' agrega una variable del siguiente modo:<br> 1a. **ID** = 'correo', **Type** = 'string', **Label** = 'Solicitud de números', **Default value** = '${mail.getText()}'.                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|     4 | **'Ingresar números de la suerte' User Task** | 1. En la pestaña 'Forms' agrega tres variables del siguiente modo:<br> 1a. **ID** = 'x', **Type** = 'long', **Label** = 'Primer número', **Validation->Add constraint->Name** = 'required'. <br> 1b. **ID** = 'y', **Type** = 'long', **Label** = 'Segundo número', **Validation->Add constraint->Name** = 'required'. <br> 1c. **ID** = 'z', **Type** = 'long', **Label** = 'Tercer número', **Validation->Add constraint->Name** = 'required'.                                                                                                                                                                                      |
|     4 | **'Enviar números de la suerte' Send Task** | 1. Configura el parámetro 'Implementation' = 'Connector'. <br> 2. Muévete a la pestaña **Connector**. Haz el atributo **Connector Id** = 'mail-send'.<br> 3. Agrega los siguientes **Input Parameters**:<br> 3a. **Name** = 'to'. **Type** = 'Text'. **Value** = `${mail.getFrom()}`. <br> 3b. **Name** = 'subject'. **Type** = 'Text'. **Value** = `${'RE: '.concat(mail.getSubject())}`. <br> 3c. **Name** = 'text'. **Type** = 'Script'. **Script Format** = 'freemarker'. **Script Type** = 'Inline Script'. **Value** = 'Buenos días<br><br>Sus números de la suerte son ${x}, ${y} y ${z}.<br><br>Saludos!   |
|     6 | **'Borrar Correo' Service Task**         | 1. Configura el parámetro 'Implementation' = 'Connector'. <br> 2. Muévete a la pestaña **Connector**. Configura el parámetro **Connector Id** = 'mail-delete'.<br> 3. Agrega los siguientes **Input Parameter**:<br> 3a. **Name** = 'mails'. **Type** = 'List'. **Value** = '${mail}'.                                                                                                                                                                                                                                                                                                                                                |
